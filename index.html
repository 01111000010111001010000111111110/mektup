<!doctype html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bir Mektup</title>
  <meta name="description" content="Benden Bana Ã§alarken okunan bir mektup." />
  <meta name="theme-color" content="#f3e9df" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- cinematic background -->
  <div class="bg" aria-hidden="true"></div>
  <div class="grain" aria-hidden="true"></div>
  <canvas id="sparkles" aria-hidden="true"></canvas>

  <!-- gate (autoplay restriction helper) -->
  <div id="gate" class="gate" hidden>
    <div class="gate__card">
      <div class="gate__icon" aria-hidden="true">ğŸ§</div>
      <h2>Bir dokunuÅŸâ€¦</h2>
      <p>MÃ¼zik ve mektup aynÄ± anda baÅŸlasÄ±n ğŸ™‚</p>
      <button id="gateBtn" class="gate__btn" type="button">BaÅŸlat</button>
      <small>(TarayÄ±cÄ± bazen otomatik sesi engelliyor.)</small>
    </div>
  </div>

  <!-- top bar -->
  <header class="site-top" role="banner">
    <div class="top-left">
      <span class="pill">ğŸ’Œ Bir Mektup</span>
      <span class="dot" aria-hidden="true">â€¢</span>
      <span class="muted">Benden Bana</span>
    </div>

    <div class="top-right">
      <span class="muted">Tarih</span>
      <span class="date" id="today">â€”</span>
      <button id="unmuteBtn" class="chip" type="button" aria-pressed="false" title="Sesi aÃ§/kapat">
        ğŸ”‡ Sessiz
      </button>
    </div>
  </header>

  <main class="wrap" role="main">
    <!-- cover -->
    <section class="cover" aria-label="Kapak">
      <div class="cover-card">
        <div class="seal" aria-hidden="true">
          <span class="seal__inner">ğŸ’</span>
        </div>

        <h1>Bir Mektup</h1>

        <p class="subtitle">
          BazÄ± gÃ¼nler â€œdoÄŸru yerde miyim?â€ diye sorulan bir cÃ¼mle,
          insanÄ±n iÃ§ini rahatlatmaya yetiyor.
        </p>

        <div class="cover-actions">
          <a class="btn" id="openLetterBtn" href="#mektup">Mektubu AÃ§</a>
          <button class="btn ghost" id="startBtn" type="button">MÃ¼zik + BaÅŸlat</button>
        </div>

        <p class="fineprint">
          Not: TarayÄ±cÄ± izin vermezse mÃ¼zik iÃ§in tek dokunuÅŸ ister. Mektup yine aÃ§Ä±lÄ±r ğŸ™‚
        </p>
      </div>
    </section>

    <!-- letter -->
    <article class="paper" id="mektup" aria-label="Mektup">
      <div class="paper__edge" aria-hidden="true"></div>

      <div class="paper-top">
        <div class="paper-title">
          <span class="label">Kime</span>
          <span class="value">Zeynep</span>
        </div>
        <div class="paper-title">
          <span class="label">Kimden</span>
          <span class="value">Levent</span>
        </div>
      </div>

      <div class="divider" aria-hidden="true"></div>

      <h2 class="salutation">Zeynep,</h2>

      <section class="letter">
        <p class="reveal">
          BugÃ¼n konuÅŸmalarÄ±mÄ±za bir daha dÃ¶ndÃ¼m. Bazen insan â€œne olmuÅŸ ki?â€ diye bakar ya,
          ben de Ã¶yle baÅŸladÄ±mâ€¦ ama en baÅŸa gelince durdum.
          <span class="quote">â€œDoÄŸru yerde miyim ki ğŸ§â€</span> dediÄŸin an,
          iÃ§imden direkt â€œevetâ€ deÄŸil de â€œiyi kiâ€ geÃ§ti.
          YazÄ±yla bile o enerjiyi vermek kolay deÄŸil, sende var.
        </p>

        <p class="reveal">
          Ä°lk dakikadan itibaren her ÅŸey doÄŸal aktÄ±. â€œAa sevindim ğŸ™‚â€, â€œNasÄ±lsÄ±nâ€â€¦
          Benim de istediÄŸim buydu zaten: kasmadan, eÄŸip bÃ¼kmeden.
          Sonra seni ekleme muhabbeti baÅŸladÄ±.
          Sen <span class="quote">â€œben pek bilmiyorumâ€</span> deyince,
          ben de â€œtamam ben anlatÄ±rÄ±mâ€ moduna girdim ğŸ˜„
          Ä°tiraf edeyim; bir ÅŸey Ã¶ÄŸretmeyi seviyorum ama daha Ã§ok,
          karÅŸÄ± tarafÄ±n â€œtamam anladÄ±mâ€ deyiÅŸini seviyorum.
        </p>

        <p class="reveal">
          Telefon ayarÄ± konusunu hatÄ±rlÄ±yor musun?
          Ben â€œistersen kapatÄ±rsÄ±nâ€ dedim, sen <span class="quote">â€œSorun deÄŸilâ€</span> dedin.
          Ben de â€œeÅŸit olalÄ±mâ€ diye saÃ§ma bir denge kurdum ğŸ˜‚
          Normalde bÃ¶yle detaylarÄ± bÃ¼yÃ¼tmem amaâ€¦ senin yanÄ±nda
          â€œadaletâ€ diye kÃ¼Ã§Ã¼k kÃ¼Ã§Ã¼k ÅŸeyler tutturabiliyorum. Garip ama hoÅŸuma gidiyor.
        </p>

        <p class="reveal">
          Mektup uygulamasÄ±ndaki <span class="quote">35 dakika bekleme</span> olayÄ±â€¦
          Sen <span class="quote">â€œEn azÄ±ndan 35 dakika beklemem ğŸ˜‹â€</span> deyince
          bir an kafamda o ekran canlandÄ±. Vallahi en yorucusu oydu.
          Ben kendimi â€œsabretmek iyidirâ€ diye motive ediyordum resmen.
          Åimdi iyi: bir mesaj uzaÄŸÄ±ndayÄ±z. Bu bile insanÄ± rahatlatÄ±yor.
        </p>

        <p class="reveal">
          Senin en sevdiÄŸim taraflarÄ±ndan biri ince olman.
          <span class="quote">â€œKalp kÄ±rmaktan Ã§ok korkuyorumâ€</span> dedin yaâ€¦
          Bunu sÃ¶yleyen birinin kalp kÄ±rmasÄ± Ã§ok zor bence.
          Ben de o yÃ¼zden baÅŸtan beri sÄ±nÄ±rlarÄ±nÄ± aÅŸmadan,
          â€œrahatsÄ±z eder miyim?â€ demeden, ama aynÄ± zamanda saklanmadan ilerlemek istedim.
          Ä°kisi aynÄ± anda zor; ama sende mÃ¼mkÃ¼n gibi duruyor.
        </p>

        <p class="reveal">
          HemÅŸireyim dediÄŸinde iÃ§imden â€œtam Zeynepâ€™e yakÄ±ÅŸÄ±râ€ dedim.
          24 saat mesaiâ€¦ 8-8â€¦ kolay deÄŸil.
          ÃœstÃ¼ne bir de insanlarla uÄŸraÅŸmak var.
          Ama sen â€œalÄ±ÅŸtÄ±mâ€ dedin ve
          â€œgÃ¼leryÃ¼zlÃ¼sÃ¼nâ€ diyorlar dedinâ€¦
          Ben buna hiÃ§ ÅŸaÅŸÄ±rmadÄ±m. Mesajdan bile belli oluyor o tarafÄ±n ğŸ™‚
        </p>

        <p class="reveal">
          Spor, maÃ§, tenis kaosu falanâ€¦ ben bunlarÄ± anlatÄ±rken senin tepkilerin Ã§ok tatlÄ±ydÄ±.
          â€œÅÄ±marÄ±k ğŸ˜’â€ deyip net tavÄ±r koyman meselaâ€¦
          Bu hoÅŸuma gitti. Ã‡Ã¼nkÃ¼ hayatta bazÄ± ÅŸeylerde net olmak lazÄ±m.
          Bir de â€œmilli maÃ§lar baÅŸkaâ€ dedin yaâ€¦
          Ben de aynÄ± yerden bakÄ±yorum. BazÄ± ÅŸeyler gerÃ§ekten baÅŸka.
        </p>

        <p class="reveal">
          Sonra ÅŸarkÄ±larâ€¦ Ben â€œSÃ¼zÃ¼lerekâ€ dedim, sen â€œGazapizm mi dinliyorsun?â€ diye gÃ¼ldÃ¼n.
          Ve sonraâ€¦ <span class="quote">â€œBenden Banaâ€</span> dedin.
          â€œYÄ±llardÄ±r listemin en Ã¼stÃ¼ndeâ€ dedin.
          O an kafama yazÄ±ldÄ±. Åu an o ÅŸarkÄ± Ã§alÄ±nca aklÄ±ma sen geliyorsa,
          bunun sebebi yapay bir romantiklik deÄŸil. BildiÄŸin alÄ±ÅŸkanlÄ±k gibi.
          Sessizce yerleÅŸti.
        </p>

        <p class="reveal">
          SatranÃ§ kÄ±smÄ±â€¦ piko005 â€“ Chesscake ğŸ˜„
          Ä°lk oyunda â€œunutmuÅŸumâ€ dedin ama bence temel var.
          â€œHamleleri yaptÄ±ktan sonra gÃ¶rÃ¼yorum riskleriâ€ dedin yaâ€¦
          iÅŸte o, zaten zihnin Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶steriyor.
          Bir de en vurucu cÃ¼mle:
          <span class="quote">â€œHÄ±rslandÄ±m Levent ğŸ˜‚ğŸ˜‚â€</span>
          Ben orada cidden gÃ¼ldÃ¼m. Ã‡Ã¼nkÃ¼ o cÃ¼mle â€œyenilirken bile oyundan Ã§Ä±kmamâ€ demek.
          Bu karakter iÅŸi.
        </p>

        <p class="reveal">
          Benim aÃ§Ä±mdan Ã¶zet ÅŸu: uzun zamandÄ±r biriyle bÃ¶yle rahat konuÅŸmamÄ±ÅŸtÄ±m.
          Kuru gÃ¼rÃ¼ltÃ¼ deÄŸilâ€¦ gerÃ§ekten sohbet.
          Senin â€œkuru gÃ¼rÃ¼ltÃ¼yÃ¼ sevmemâ€ demen var yaâ€¦ aynÄ±yÄ±z.
          O yÃ¼zden konuÅŸurken yorulmuyorum.
          Tam tersine, gÃ¼nÃ¼n iÃ§inde kÃ¼Ã§Ã¼k bir â€œiyi geldiâ€ anÄ± oluyor.
        </p>

        <p class="reveal">
          Bir de ÅŸunu ekleyeyim:
          Ben her ÅŸeyi â€œmÃ¼kemmelâ€ kurmaya Ã§alÄ±ÅŸmÄ±yorum.
          Sadece gerÃ§ek hayatta nasÄ±lsam burada da Ã¶yle olmaya Ã§alÄ±ÅŸÄ±yorum.
          Bunu da sen zaten fark etmiÅŸsin:
          â€œBazen yapay zekayla mÄ± konuÅŸuyorum?â€ demiÅŸtin ğŸ˜„
          Ä°tiraf: mektup uygulamasÄ±nda gramer dÃ¼zeltmesi almÄ±ÅŸtÄ±m bir ara.
          Ama sen â€œdevam etse silerdimâ€ deyinceâ€¦ ben de rahatladÄ±m.
          Ã‡Ã¼nkÃ¼ benim iÃ§in deÄŸerli olan dÃ¼zgÃ¼n cÃ¼mle deÄŸil,
          senin â€œbu benimâ€ diyebileceÄŸin bir samimiyet.
        </p>

        <p class="closing reveal">
          Neyseâ€¦ uzatÄ±yorum ben. Ama hani demiÅŸtim ya:
          â€œMektup gibi uzun uzun yazasÄ±m geliyorâ€ ğŸ˜„
          Ne zaman istersen yaz.
          Ben buradayÄ±m.
          Bir mesaj uzaÄŸÄ±ndayÄ±m.
        </p>

        <div class="signature reveal">
          <div class="sig-line" aria-hidden="true"></div>
          <p class="sig-name">Levent ğŸ™‚</p>
          <p class="sig-note">PS: Tabletâ€™e de kur. Bir el daha oynarÄ±z. â™Ÿï¸</p>
        </div>
      </section>

      <footer class="paper-footer" aria-label="Alt bilgi">
        <button class="chip" type="button" id="scrollTop">â†‘ YukarÄ±</button>
        <span class="muted">GitHub Pages</span>
      </footer>
    </article>
  </main>

  <!-- Music (ROOT) -->
  <audio id="bgm" loop preload="auto" autoplay playsinline></audio>

  <script>
    // Tarih
    const d = new Date();
    const fmt = new Intl.DateTimeFormat('tr-TR', { day: '2-digit', month: 'long', year: 'numeric' });
    document.getElementById('today').textContent = fmt.format(d);

    // ROOT'TA mp3
    const audio = document.getElementById('bgm');
    audio.src = "loop.mp3";

    const gate = document.getElementById('gate');
    const gateBtn = document.getElementById('gateBtn');
    const unmuteBtn = document.getElementById('unmuteBtn');
    const startBtn = document.getElementById('startBtn');

    function setMuteUI(){
      const muted = audio.muted || audio.volume === 0;
      unmuteBtn.textContent = muted ? "ğŸ”‡ Sessiz" : "ğŸ”Š Ses AÃ§Ä±k";
      unmuteBtn.setAttribute("aria-pressed", String(!muted));
    }

    function goToLetter(){
      const target = document.getElementById('mektup');
      if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      location.hash = '#mektup';
    }

    async function tryAutoplayMuted(){
      audio.muted = true;
      audio.volume = 1.0;
      try {
        await audio.play();
        setMuteUI();
        return true;
      } catch {
        return false;
      }
    }

    async function unmuteAndPlay(){
      audio.muted = false;
      try { await audio.play(); } catch {}
      setMuteUI();
    }

    // Init autoplay attempt
    (async () => {
      const ok = await tryAutoplayMuted();
      if (!ok) gate.hidden = false;

      // Ä°lk kullanÄ±cÄ± hareketi: kapÄ±yÄ± kapat, mektuba geÃ§, sesi aÃ§mayÄ± dene
      const unlock = async () => {
        if (!gate.hidden) gate.hidden = true;
        goToLetter();
        await unmuteAndPlay();
      };

      window.addEventListener('pointerdown', unlock, { once: true });
      window.addEventListener('keydown', unlock, { once: true });

      setMuteUI();
    })();

    // Gate button: GARANTÄ° geÃ§iÅŸ
    gateBtn.addEventListener('click', async (e) => {
      e.preventDefault();
      gate.hidden = true;     // 1) kapat
      goToLetter();           // 2) mektuba kaydÄ±r
      await unmuteAndPlay();  // 3) sesi aÃ§mayÄ± dene
    });

    // Start button on cover
    startBtn.addEventListener('click', async () => {
      goToLetter();
      await unmuteAndPlay();
    });

    // Manual toggle
    unmuteBtn.addEventListener('click', async () => {
      if (audio.muted || audio.volume === 0) {
        await unmuteAndPlay();
      } else {
        audio.muted = true;
        setMuteUI();
      }
    });

    // Scroll top
    document.getElementById('scrollTop').addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Reveal paragraphs
    const els = document.querySelectorAll('.reveal');
    const io = new IntersectionObserver((entries) => {
      for (const e of entries) if (e.isIntersecting) e.target.classList.add('in');
    }, { threshold: 0.14 });
    els.forEach(el => io.observe(el));

    // Sparkles canvas
    const canvas = document.getElementById('sparkles');
    const ctx = canvas.getContext('2d');
    let W, H, t = 0;

    const sparks = Array.from({ length: 110 }, () => ({
      x: Math.random(),
      y: Math.random(),
      r: Math.random() * 2.0 + 0.4,
      s: Math.random() * 0.28 + 0.06,
      p: Math.random() * Math.PI * 2
    }));

    function resize(){
      W = canvas.width = window.innerWidth;
      H = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function draw(){
      t += 0.008;
      ctx.clearRect(0, 0, W, H);

      // soft rose glow
      const glow = ctx.createRadialGradient(W*0.18, H*0.12, 0, W*0.18, H*0.12, Math.min(W,H)*0.85);
      glow.addColorStop(0, 'rgba(170,88,110,0.10)');
      glow.addColorStop(1, 'rgba(170,88,110,0)');
      ctx.fillStyle = glow;
      ctx.fillRect(0, 0, W, H);

      for (const s of sparks){
        const x = (s.x + Math.sin(t + s.p)*0.012) * W;
        const y = (s.y + Math.cos(t*0.85 + s.p)*0.012) * H;
        const a = 0.10 + 0.18*Math.sin(t*3.2 + s.p);

        ctx.beginPath();
        ctx.arc(x, y, s.r*(1+0.25*Math.sin(t*2+s.p)), 0, Math.PI*2);
        ctx.fillStyle = `rgba(255,255,255,${a})`;
        ctx.fill();

        s.y -= s.s/1000;
        if (s.y < -0.06) { s.y = 1.06; s.x = Math.random(); }
      }

      requestAnimationFrame(draw);
    }
    draw();
  </script>
</body>
</html>
