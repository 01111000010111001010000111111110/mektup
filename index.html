<!doctype html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bir Mektup</title>
  <meta name="description" content="Benden Bana Ã§alarken okunan bir mektup." />
  <meta name="theme-color" content="#f3e9df" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="bg" aria-hidden="true"></div>
  <canvas id="sparkles" aria-hidden="true"></canvas>

  <!-- Autoplay helper overlay (only if needed) -->
  <div id="gate" class="gate" hidden>
    <div class="gate__card">
      <div class="gate__icon">ğŸ§</div>
      <h2>Bir dokunuÅŸâ€¦</h2>
      <p>MÃ¼zik ve mektup aynÄ± anda baÅŸlasÄ±n ğŸ™‚</p>
      <button id="gateBtn" class="gate__btn" type="button">BaÅŸlat</button>
      <small>(TarayÄ±cÄ± bazen otomatik sesi engelliyor.)</small>
    </div>
  </div>

  <header class="site-top" role="banner">
    <div class="top-left">
      <span class="pill">ğŸ§ Benden Bana</span>
      <span class="dot" aria-hidden="true">â€¢</span>
      <span class="muted">bizim ÅŸarkÄ±</span>
    </div>

    <div class="top-right">
      <span class="muted">Tarih</span>
      <span class="date" id="today">â€”</span>
      <button id="unmuteBtn" class="chip" type="button" aria-pressed="false" title="Sesi aÃ§/kapat">
        ğŸ”‡ Sessiz
      </button>
    </div>
  </header>

  <main class="wrap" role="main">
    <section class="cover" aria-label="Kapak">
      <div class="cover-card">
        <div class="stamp" aria-hidden="true">ğŸ’</div>
        <h1>Bir Mektup</h1>
        <p class="subtitle">
          â€œDoÄŸru yerde miyim?â€ diye sorulan bir cÃ¼mleâ€¦
          bazen gÃ¼nÃ¼ gÃ¼zelleÅŸtirmeye yetiyor.
        </p>

        <div class="cover-actions">
          <a class="btn" href="#mektup">Mektubu AÃ§</a>
        </div>

        <p class="fineprint">
          MÃ¼zik otomatik baÅŸlar; tarayÄ±cÄ± izin vermezse tek dokunuÅŸ ister. (Zarif Ã§Ã¶zÃ¼m ğŸ˜„)
        </p>
      </div>
    </section>

    <article class="paper" id="mektup" aria-label="Mektup">
      <div class="paper-top">
        <div class="paper-title">
          <span class="label">Kime:</span>
          <span class="value">Zeynep</span>
        </div>
        <div class="paper-title">
          <span class="label">Kimden:</span>
          <span class="value">Levent</span>
        </div>
      </div>

      <div class="divider" aria-hidden="true"></div>
      <h2 class="salutation">Zeynep,</h2>

      <section class="letter">
        <p class="reveal">
          BugÃ¼n konuÅŸmalarÄ±mÄ±za bir daha baktÄ±m. Åu sabah yazdÄ±ÄŸÄ±n ilk cÃ¼mle var yaâ€¦
          <span class="quote">â€œDoÄŸru yerde miyim ki ğŸ§â€</span>
          ben o an cidden sevindim ğŸ™‚ â€œEvetâ€ dedim ama iÃ§imden direkt â€œiyi kiâ€ diye geÃ§irdim.
        </p>

        <p class="reveal">
          Sonra olaylar Ã§ok doÄŸal aktÄ±. â€œAa sevindimâ€, â€œNasÄ±lsÄ±nâ€, ben â€œiyiyim sen?â€
          Hani bÃ¶yle kasÄ±ntÄ± deÄŸil. Bu bana iyi geldi.
          Bir de seni ekleme muhabbetiâ€¦ â€œben pek bilmiyorumâ€ dedin ya ğŸ˜„
          normal yani, ben de her ÅŸeyi bilmiyorum zaten.
        </p>

        <p class="reveal">
          Telefon konusu komikti biraz. Ben â€œtelefonun gÃ¶zÃ¼kÃ¼yor istersen kapatâ€ dedim,
          sen <span class="quote">â€œSorun deÄŸilâ€</span> dedin.
          Ben de â€œo zaman ben de aÃ§ayÄ±mâ€ diye saÃ§ma bir adalet sistemi kurdum ğŸ˜‚
          (EÅŸit olalÄ±m dedim yaâ€¦ biraz benlik iÅŸte.)
        </p>

        <p class="reveal">
          Sonra ben â€œmektup gibi uzun uzun yazasÄ±m geliyorâ€ dedim.
          Sen de â€œyazabilirsinâ€ dedin.
          Bir de Ã¼stÃ¼ne <span class="quote">â€œEn azÄ±ndan 35 dakika beklemem ğŸ˜‹â€</span>â€¦
          ahaha. Vallahi en yorucusu oydu. Ben sabÄ±r sabÄ±r diye kendimi gazlÄ±yordum resmen.
        </p>

        <p class="reveal">
          Senin hoÅŸuma giden bir ÅŸey var: ince dÃ¼ÅŸÃ¼nÃ¼yorsun.
          <span class="quote">â€œKalp kÄ±rmaktan korkuyorumâ€</span> dedin yaâ€¦
          bunu sÃ¶yleyen biri kolay kolay kÄ±rmaz bence.
          Ben de o yÃ¼zden baÅŸtan beri sÄ±nÄ±rlarÄ±nÄ± aÅŸmayayÄ±m diye ekstra dikkat ettim.
        </p>

        <p class="reveal">
          HemÅŸireyim dediÄŸinde iÃ§imden â€œtam Zeynepâ€™e yakÄ±ÅŸÄ±râ€ dedim.
          24 saat mesaiâ€¦ 8-8â€¦ Ã§ok aÄŸÄ±r.
          Ama sen â€œalÄ±ÅŸtÄ±mâ€ dedin, Ã¼stÃ¼ne bir de â€œgÃ¼leryÃ¼zlÃ¼sÃ¼nâ€ diyorlar dedin.
          HiÃ§ ÅŸaÅŸÄ±rmadÄ±m ğŸ™‚ gerÃ§ekten mesajdan bile belli oluyor.
        </p>

        <p class="reveal">
          SatranÃ§ kÄ±smÄ±â€¦ bence gÃ¼nÃ¼n en keyifli yeriydi.
          piko005 â€“ Chesscake ilk maÃ§Ä±mÄ±zda â€œunutmuÅŸumâ€ dedin ama yine iyi oynadÄ±n.
          Bir de <span class="quote">â€œHÄ±rslandÄ±m Levent ğŸ˜‚ğŸ˜‚â€</span>â€¦
          ben orada koptum ğŸ˜„
        </p>

        <p class="reveal">
          MÃ¼zik konusu da ayrÄ± bir â€œbizâ€ oldu.
          Sen <span class="quote">â€œBenden Banaâ€</span> dedin yaâ€¦ yÄ±llardÄ±r en Ã¼stte.
          Ben de fark ettim: artÄ±k o ÅŸarkÄ± Ã§alÄ±nca aklÄ±ma sen geliyorsun.
          Zorla deÄŸil, kendiliÄŸinden oluyor. O yÃ¼zden gÃ¼zel.
        </p>

        <p class="reveal">
          BÃ¼yÃ¼k laflara girmeyeyim.
          Senin dediÄŸin gibi: zaman gÃ¶sterir.
          Ama ÅŸunu net sÃ¶yleyeyim; ben uzun zamandÄ±r biriyle bu kadar rahat konuÅŸmamÄ±ÅŸtÄ±m.
          Kuru gÃ¼rÃ¼ltÃ¼ deÄŸilâ€¦ gerÃ§ekten sohbet.
        </p>

        <p class="closing reveal">
          Ne zaman istersen yaz.
          Ben buradayÄ±m.
          Bir mesaj uzaÄŸÄ±ndayÄ±m.
        </p>

        <div class="signature reveal">
          <div class="sig-line" aria-hidden="true"></div>
          <p class="sig-name">Levent ğŸ˜Š</p>
          <p class="sig-note">PS: Tabletâ€™e yÃ¼kleyince bir el daha. â™Ÿï¸</p>
        </div>
      </section>

      <footer class="paper-footer">
        <button class="chip" type="button" id="scrollTop">â†‘ YukarÄ±</button>
        <span class="muted">GitHub Pages</span>
      </footer>
    </article>
  </main>

  <!-- Music (ROOT: loop.mp3) -->
  <audio id="bgm" loop preload="auto" autoplay playsinline></audio>

  <script>
    // Tarih
    const d = new Date();
    const fmt = new Intl.DateTimeFormat('tr-TR', { day: '2-digit', month: 'long', year: 'numeric' });
    document.getElementById('today').textContent = fmt.format(d);

    // âœ… ROOT'TA: loop.mp3
    const audio = document.getElementById('bgm');
    audio.src = "loop.mp3";

    const unmuteBtn = document.getElementById('unmuteBtn');
    const gate = document.getElementById('gate');
    const gateBtn = document.getElementById('gateBtn');

    function setMuteUI(){
      const muted = audio.muted || audio.volume === 0;
      unmuteBtn.textContent = muted ? "ğŸ”‡ Sessiz" : "ğŸ”Š Ses AÃ§Ä±k";
      unmuteBtn.setAttribute("aria-pressed", String(!muted));
    }

    async function tryAutoplayMuted(){
      audio.muted = true;
      audio.volume = 1.0;
      try {
        await audio.play();
        setMuteUI();
        return true;
      } catch {
        return false;
      }
    }

    async function unmuteAndPlay(){
      audio.muted = false;
      try { await audio.play(); } catch {}
      setMuteUI();
    }

    (async () => {
      const ok = await tryAutoplayMuted();
      if (!ok) gate.hidden = false;

      const unlock = async () => {
        await unmuteAndPlay();
        gate.hidden = true;
      };
      window.addEventListener('pointerdown', unlock, { once: true });
      window.addEventListener('keydown', unlock, { once: true });

      setMuteUI();
    })();

    unmuteBtn.addEventListener('click', async () => {
      if (audio.muted || audio.volume === 0) {
        await unmuteAndPlay();
      } else {
        audio.muted = true;
        setMuteUI();
      }
    });

    gateBtn.addEventListener('click', async () => {
      await unmuteAndPlay();
      gate.hidden = true;
    });

    document.getElementById('scrollTop').addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Reveal on scroll
    const els = document.querySelectorAll('.reveal');
    const io = new IntersectionObserver((entries) => {
      for (const e of entries) if (e.isIntersecting) e.target.classList.add('in');
    }, { threshold: 0.12 });
    els.forEach(el => io.observe(el));

    // Sparkles canvas
    const canvas = document.getElementById('sparkles');
    const ctx = canvas.getContext('2d');
    let W, H, t = 0;

    const sparks = Array.from({ length: 90 }, () => ({
      x: Math.random(),
      y: Math.random(),
      r: Math.random() * 1.9 + 0.5,
      s: Math.random() * 0.25 + 0.05,
      p: Math.random() * Math.PI * 2
    }));

    function resize(){
      W = canvas.width = window.innerWidth;
      H = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function draw(){
      t += 0.008;
      ctx.clearRect(0, 0, W, H);

      const g = ctx.createRadialGradient(W*0.2, H*0.15, 0, W*0.2, H*0.15, Math.min(W,H)*0.75);
      g.addColorStop(0, 'rgba(146,76,96,0.10)');
      g.addColorStop(1, 'rgba(146,76,96,0)');
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, W, H);

      for (const s of sparks){
        const x = (s.x + Math.sin(t + s.p)*0.012) * W;
        const y = (s.y + Math.cos(t*0.8 + s.p)*0.012) * H;
        const a = 0.14 + 0.14*Math.sin(t*3 + s.p);

        ctx.beginPath();
        ctx.arc(x, y, s.r*(1+0.22*Math.sin(t*2+s.p)), 0, Math.PI*2);
        ctx.fillStyle = `rgba(255,255,255,${a})`;
        ctx.fill();

        s.y -= s.s/1000;
        if (s.y < -0.05) { s.y = 1.05; s.x = Math.random(); }
      }
      requestAnimationFrame(draw);
    }
    draw();
  </script>
</body>
</html>
